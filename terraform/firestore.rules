rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Lock down all documents by default
    match /{document=**} {
      allow read, write: if false;
    }

    // Allow public read access only to the 'visits' collection for a limited time,
    // but disallow writes completely from the client.
    // This allows the front-end to read the visitor count without authentication.
    // The server-side code (Cloud Run/GKE) will have privileged access to write.
    match /visits/{visit} {
      allow read: if request.time < timestamp.date(2026, 1, 1);
      allow write: if false; // Disallow client-side writes entirely
    }
  }
}
